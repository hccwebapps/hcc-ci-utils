description: >
  Pushes an image to ECR with the specified tags.
parameters:
  repo:
    type: string
    default: ${CIRCLE_PROJECT_REPONAME}
  tags:
    type: string
    default: latest,${BRANCH},rev-${SHORT_GIT_HASH}
steps:
  - run: |
      IFS="," read -ra DOCKER_TAGS \<<< "<< parameters.tags >>"
      for tag in "${DOCKER_TAGS[@]}"; do
          docker push ${AWS_ECR_ACCOUNT_URL}/<<parameters.repo>>:${tag}
      done
